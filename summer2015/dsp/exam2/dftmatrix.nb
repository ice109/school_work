(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13337,        441]
NotebookOptionsPosition[     11731,        382]
NotebookOutlinePosition[     12065,        397]
CellTagsIndexPosition[     12022,        394]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"W", "[", "n_", "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", "2", 
    RowBox[{"\[Pi]", "/", "n"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643375052377594*^9, 3.6433750724840508`*^9}, {
   3.643375189688448*^9, 3.643375189953388*^9}, 3.643385812656126*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dmat", "[", "n_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"W", "[", "n", "]"}], 
     RowBox[{"i", " ", "j"}]], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{"n", "-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.643385815291068*^9, 3.643385842874633*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FT", "[", "l_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Dmat", "[", 
    RowBox[{"Length", "[", "l", "]"}], "]"}], ".", "l"}]}]], "Input",
 CellChangeTimes->{{3.6433861236522713`*^9, 3.643386129902248*^9}, {
  3.643386193524486*^9, 3.643386199610355*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"freqpow", "[", "l_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"Length", "[", "l", "]"}]], 
   RowBox[{
    RowBox[{
     RowBox[{"Norm", "[", "l", "]"}], "^", "2"}], "/", 
    RowBox[{"Length", "[", "l", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.643386595150915*^9, 3.643386616130863*^9}, {
  3.643386760257523*^9, 3.6433868174958487`*^9}, {3.643386918264247*^9, 
  3.643386969342454*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"freqpow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"3", "+", 
     RowBox[{"3", " ", "\[ImaginaryI]"}]}], ",", "0", ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6434865905346613`*^9, 3.6434865987861853`*^9}, 
   3.6434866605120583`*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.643486660951635*^9, 3.643488868344884*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FT", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
     RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
     RowBox[{"1", "+", "\[ImaginaryI]"}]}], "}"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.643486640990946*^9, 3.643486654384403*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"3", "+", 
    RowBox[{"3", " ", "\[ImaginaryI]"}]}], ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.643486599024602*^9, {3.643486650707026*^9, 3.643486654639679*^9}, 
   3.643488868466325*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"timpow", "[", "l_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", "l", "]"}], 
   RowBox[{"freqpow", "[", "l", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.643386848907267*^9, 3.643386872046225*^9}, {
  3.643386960486264*^9, 3.643386978687924*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IDFT", "[", "l_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{"Dmat", "[", 
     RowBox[{"Length", "[", "l", "]"}], "]"}], "]"}], ".", "l"}]}]], "Input",
 CellChangeTimes->{{3.643482384113576*^9, 3.643482408658308*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nextpowN", "[", 
    RowBox[{"n_", ",", "a_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "^", 
      RowBox[{"Ceiling", "@", 
       RowBox[{"Log", "[", 
        RowBox[{"n", ",", 
         RowBox[{"Abs", "@", "a"}]}], "]"}]}]}], ",", 
     RowBox[{"Ceiling", "@", 
      RowBox[{"Log", "[", 
       RowBox[{"n", ",", 
        RowBox[{"Abs", "@", "a"}]}], "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.643482585926703*^9, 3.643482585927512*^9}, {
  3.643482627462282*^9, 3.6434826283001347`*^9}, {3.643483946294093*^9, 
  3.643483976838048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"primefaq", "[", "m_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"fs", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"fs", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"fs", ",", 
       RowBox[{"FactorInteger", "[", "m", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6434841138066053`*^9, 3.643484248072843*^9}, {
  3.6434842805140142`*^9, 3.643484283159134*^9}, {3.643484611043151*^9, 
  3.643484619145071*^9}, {3.643484880338171*^9, 3.643484908310474*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"shortffts", "[", "m_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Times", "@@", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"primefaq", "[", "m", "]"}], ",", 
         RowBox[{"{", "i", "}"}]}], "]"}]}], ",", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{"primefaq", "[", "m", "]"}], ",", 
        RowBox[{"{", "i", "}"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"primefaq", "[", "m", "]"}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6434843621367073`*^9, 3.643484362509062*^9}, {
  3.643484403754038*^9, 3.643484416187072*^9}, {3.64348446671001*^9, 
  3.643484596362296*^9}, {3.64348462826788*^9, 3.643484633676346*^9}, {
  3.6434846748673677`*^9, 3.6434847317826853`*^9}, {3.643484912927905*^9, 
  3.643484930406045*^9}, {3.643485053474669*^9, 3.643485058544771*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"goodthomfft", "[", 
   RowBox[{"m_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Times", "@@", "n"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Subsets", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Prime", "[", "n", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "k"}], "}"}]}], "]"}], "]"}]}], "}"}]}], 
        "]"}], ",", "Last"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Last", "[", "#", "]"}], "\[GreaterEqual]", "m"}], "&"}]}], 
    "]"}], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.643483025452862*^9, 3.643483214645276*^9}, {
   3.643485112311329*^9, 3.6434851266586523`*^9}, 3.6434851862012033`*^9, {
   3.643485737108137*^9, 3.643485765590732*^9}, {3.6434858664867992`*^9, 
   3.6434858716917953`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"circflip", "[", "l_", "]"}], ":=", 
  RowBox[{"RotateRight", "[", 
   RowBox[{
    RowBox[{"Reverse", "[", "l", "]"}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6434886996615334`*^9, 3.643488725473483*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"circflip", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "8"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6434887379877377`*^9, 3.643488755604301*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6434887559711647`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6434887698154*^9, 3.6434887777044067`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6434887790207577`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"X1", "=", 
  FractionBox[
   RowBox[{"x", "+", 
    RowBox[{"Conjugate", "[", 
     RowBox[{"circflip", "[", "x", "]"}], "]"}]}], "2"]}]], "Input",
 CellChangeTimes->{{3.643488787832814*^9, 3.6434888014812326`*^9}, {
  3.643488901518821*^9, 3.643488902658492*^9}, {3.643488932833507*^9, 
  3.6434889334748383`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}],
   "}"}]], "Output",
 CellChangeTimes->{3.643488801697238*^9, 3.643488903024816*^9, 
  3.643488937523629*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"X2", "=", 
  FractionBox[
   RowBox[{"x", "-", 
    RowBox[{"Conjugate", "[", 
     RowBox[{"circflip", "[", "x", "]"}], "]"}]}], 
   RowBox[{"2", "\[ImaginaryI]"}]]}]], "Input",
 CellChangeTimes->{{3.6434888175192947`*^9, 3.6434888226821213`*^9}, {
  3.643488905220357*^9, 3.64348893542063*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}],
   "}"}]], "Output",
 CellChangeTimes->{3.6434888229762173`*^9, 3.64348890618005*^9, 
  3.643488938399967*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x1", "=", 
  RowBox[{
   RowBox[{"IDFT", "[", "X1", "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6434888728598013`*^9, 3.643488958472433*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.6434888803426237`*^9, 3.6434889592569942`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x2", "=", 
  RowBox[{
   RowBox[{"IDFT", "[", "X2", "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6434889183176727`*^9, 3.643488960741337*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.643488921421196*^9, 3.643488961139544*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FT", "[", 
  RowBox[{"x1", "+", 
   RowBox[{"\[ImaginaryI]", " ", "x2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.643488950497637*^9, 3.643488966871668*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}], ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.643488967263153*^9}]
}, Open  ]]
},
WindowSize->{1366, 739},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 339, 8, 32, "Input"],
Cell[900, 30, 473, 14, 41, "Input"],
Cell[1376, 46, 287, 7, 32, "Input"],
Cell[1666, 55, 444, 12, 59, "Input"],
Cell[CellGroupData[{
Cell[2135, 71, 281, 8, 32, "Input"],
Cell[2419, 81, 92, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2548, 87, 332, 9, 32, "Input"],
Cell[2883, 98, 264, 8, 32, "Output"]
}, Open  ]],
Cell[3162, 109, 286, 7, 32, "Input"],
Cell[3451, 118, 275, 7, 32, "Input"],
Cell[3729, 127, 626, 18, 32, "Input"],
Cell[4358, 147, 744, 20, 32, "Input"],
Cell[5105, 169, 986, 25, 32, "Input"],
Cell[6094, 196, 1089, 30, 32, "Input"],
Cell[7186, 228, 252, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[7463, 238, 273, 7, 32, "Input"],
Cell[7739, 247, 465, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8241, 263, 259, 7, 32, "Input"],
Cell[8503, 272, 465, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9005, 288, 339, 8, 56, "Input"],
Cell[9347, 298, 228, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9612, 309, 320, 8, 56, "Input"],
Cell[9935, 319, 229, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10201, 330, 186, 4, 32, "Input"],
Cell[10390, 336, 209, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10636, 346, 186, 4, 32, "Input"],
Cell[10825, 352, 205, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11067, 362, 182, 4, 32, "Input"],
Cell[11252, 368, 463, 11, 65, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
